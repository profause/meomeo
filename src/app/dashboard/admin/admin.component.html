<app-bar title="Dashboard"></app-bar>
<main class="container" style="margin-top: 80px">
  <div class="row align-items-center">
    <nav class="col-12" aria-label="breadcrumb">
      <ol class="p-0 breadcrumb" style="background: transparent !important">
        <li class="breadcrumb-item"><a routerLink="/home">Home</a></li>
        <li class="breadcrumb-item active" aria-current="page">dashboard</li>
      </ol>
    </nav>
    <div class="col-12">
      <article
        class="m-0 mb-3 p-2"
        style="background-color: #04aaf1; color: white !important"
      >
        <div
          [bdcWalkTriggerFor]="bdcsubscription"
          class="d-flex justify-content-between align-items-center"
        >
          <h4 class="m-0 color-white">Subscription</h4>
          <a
            class="color-white"
            style="text-decoration: none"
            [routerLink]="['/subscription']"
            mat-button
          >
            Details
            <mat-icon>arrow_right_alt</mat-icon>
          </a>
        </div>
        <p
          class="mt-3 color-white font-weight-300"
          *ngIf="authUser.account?.subscription?.id == undefined"
        >
          No subscription yet. Click on details to view subscription plans.
        </p>
        <div
          class="mt-3"
          *ngIf="authUser.account?.subscription?.id != undefined"
        >
          <p class="p-0 m-0 color-white bold">
            {{ authUser.account?.subscription.name }}
          </p>
          <p class="p-0 m-0 color-white" style="font-size: 15px">
            Start date:
            {{
              timestampToDate(
                authUser.account?.subscription?.startDate,
                "YYYY-MM-DD"
              )
            }}
          </p>
          <p class="p-0 m-0 color-white" style="font-size: 15px">
            Due date:
            {{
              timestampToDate(
                authUser.account?.subscription?.nextPaymentDate,
                "YYYY-MM-DD"
              )
            }}
          </p>
        </div>
      </article>
    </div>
    <div class="col-6">
      <article class="m-0 mb-3 p-2" style="background-color: #7e91f1">
        <div
          [bdcWalkTriggerFor]="bdcaddUser"
          class="d-flex justify-content-between align-items-center"
        >
          <h4 class="m-0 color-white">Users</h4>
          <a
            class="color-white"
            style="text-decoration: none"
            [routerLink]="['/users']"
            mat-button
          >
            More
            <mat-icon>arrow_right_alt</mat-icon>
          </a>
        </div>
        <div class="mt-3">
          <h3 class="m-0 p-0 color-white">{{ numberOfUsers$ | async }}</h3>
          <div [hidden]="numberOfUsers$ | async" aria-busy="true"></div>
        </div>
      </article>
    </div>
    <div class="col-6">
        <article class="m-0 mb-3 p-2" style="background-color: #7e91f1">
            <div
              [bdcWalkTriggerFor]="bdcaddUser"
              class="d-flex justify-content-between align-items-center"
            >
              <h4 class="m-0 color-white">System Setup</h4>
              <a
                class="color-white"
                style="text-decoration: none"
                [routerLink]="['/admin/setup']"
                mat-button
              >
                More
                <mat-icon>arrow_right_alt</mat-icon>
              </a>
            </div>
            <div class="mt-3">
              <h3 class="m-0 p-0 color-white">{{ numberOfUsers$ | async }}</h3>
              <div [hidden]="numberOfUsers$ | async" aria-busy="true"></div>
            </div>
          </article>
    </div>
    <div class="col-12">
        <article class="m-0 mb-3 p-2" style="background-color: #334e52;">
            <div class="d-flex justify-content-between align-items-center">
                <h4 class="m-0 color-white font-poppins">Customers</h4>
                <a class="color-white" style="text-decoration: none;" [routerLink]="['/customers']" mat-button>
                    More
                    <mat-icon>arrow_right_alt</mat-icon>
                </a>
            </div>
            <div class="mt-3">
                <h3 class="m-0 p-0 color-white">{{numberOfCustomers$|async}}</h3>
                <div class="color-white" [hidden]="(numberOfCustomers$ | async) >=0" aria-busy="true"></div>
            </div>
        </article>
    </div>
    <div class="col-12">
        <article class="m-0 mb-3 p-1">
            <h4 class="">List of users</h4>
            <div class="table-responsive bg-white rounded" style="max-height: 520px;">
                <table class="table bg-white table-striped table-sm">
                    <thead>
                        <tr>
                            <th scope="col">Full name</th>
                            <th scope="col">Mobile number</th>
                            <th scope="col">Role</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let user of userList$ | async; let i=index;">
                            <th scope="row">{{user?.fullname}}</th>
                            <td>{{user?.mobileNumber}}</td>
                            <td>{{user.role}}</td>
                        </tr>
                    </tbody>
                </table>
                <div [hidden]="userList$ | async" aria-busy="true"></div>
            </div>
        </article>
    </div>
  </div>
</main>
<bdc-walk-popup
  #bdcsubscription
  name="bdcsubscription"
  header="Subscription"
  xPosition="after"
  sideNoteText=""
  [showButton]="true"
  buttonText="Next"
  [onButtonCompleteTask]="{ bdcNext: 1 }"
>
  10 days free trial. No payment required.
</bdc-walk-popup>

<bdc-walk-popup
  #bdcaddUser
  name="bdcaddUser"
  header="Add Users"
  xPosition="after"
  sideNoteText=""
  [showButton]="true"
  buttonText="Go it"
  [mustCompleted]="{ bdcNext: 1 }"
  [onButtonCompleteTask]="{ bdcNext: 2 }"
>
  Add users to your newly created account
</bdc-walk-popup>
